<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-æ·»åŠ éƒ¨é—¨è¡¨(5)</title>
    <url>/2024/08/07/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E6%B7%BB%E5%8A%A0%E9%83%A8%E9%97%A8%E8%A1%A8-5/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="1-è¯¦è§£éƒ¨é—¨è¡¨"><a href="#1-è¯¦è§£éƒ¨é—¨è¡¨" class="headerlink" title="1. è¯¦è§£éƒ¨é—¨è¡¨"></a>1. è¯¦è§£éƒ¨é—¨è¡¨</h3><p><img src="https://s2.loli.net/2024/08/07/OX2dkv6u1xPziE3.png"></p>
<ul>
<li>è‘£äº‹ä¼šï¼šç”±å¼ ä¸‰å’Œæå››ç»„æˆã€‚</li>
<li>è¿è¥éƒ¨ï¼šç”±ä¸€ä¸ªé¢†å¯¼(AAè¿è¥)è´Ÿè´£ï¼Œéƒ¨é—¨ä¸‹æœ‰å››åå‘˜å·¥ã€‚</li>
<li>æŠ€æœ¯éƒ¨ï¼šåŒæ ·ç”±ä¸€ä¸ªé¢†å¯¼(BBæŠ€æœ¯)è´Ÿè´£ï¼Œéƒ¨é—¨ä¸‹æœ‰å››åå‘˜å·¥ã€‚</li>
<li>é”€å”®éƒ¨ï¼šç”±ä¸€ä¸ªé¢†å¯¼(CCé”€å”®)è´Ÿè´£ï¼Œéƒ¨é—¨ä¸‹æœ‰å››åå‘˜å·¥ã€‚</li>
<li>è¡Œæ”¿éƒ¨ï¼šç”±ä¸€ä¸ªé¢†å¯¼(DDè¡Œæ”¿)è´Ÿè´£ï¼Œéƒ¨é—¨ä¸‹ä¹Ÿæœ‰å››åå‘˜å·¥ã€‚</li>
</ul>
<ul>
<li>AAè¿è¥,BBæŠ€æœ¯,CCé”€å”®,DDè¡Œæ”¿åˆ†åˆ«æ˜¯å››ä¸ªéƒ¨é—¨çš„é¢†å¯¼  </li>
<li>å¼ ä¸‰æ˜¯è¿è¥éƒ¨å’ŒæŠ€æœ¯éƒ¨çš„ç»ç†ã€‚  </li>
<li>æå››æ˜¯é”€å”®éƒ¨å’Œè¡Œæ”¿éƒ¨çš„ç»ç†ã€‚</li>
</ul>
<h2 id="æ–°å»ºéƒ¨é—¨è¡¨æ¨¡å‹"><a href="#æ–°å»ºéƒ¨é—¨è¡¨æ¨¡å‹" class="headerlink" title="æ–°å»ºéƒ¨é—¨è¡¨æ¨¡å‹"></a>æ–°å»ºéƒ¨é—¨è¡¨æ¨¡å‹</h2><h3 id="åˆ›å»ºOADepartmentéƒ¨é—¨è¡¨æ¨¡å‹"><a href="#åˆ›å»ºOADepartmentéƒ¨é—¨è¡¨æ¨¡å‹" class="headerlink" title="åˆ›å»ºOADepartmentéƒ¨é—¨è¡¨æ¨¡å‹"></a>åˆ›å»ºOADepartmentéƒ¨é—¨è¡¨æ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OADepartment</span>(models.Model):</span><br><span class="line">    name = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">    intro = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    <span class="comment"># leader: ç›®å‰å‡è®¾ä¸€ä¸ªéƒ¨é—¨åªæœ‰ä¸€ä¸ªleader,ä¸€ä¸ªleaderåªèƒ½ç®¡ç†ä¸€ä¸ªéƒ¨é—¨(émanager)</span></span><br><span class="line">    <span class="comment"># related_query_name: ç”¨äºè·¨è¡¨æŸ¥è¯¢</span></span><br><span class="line">    leader = models.OneToOneField(OAUser, on_delete=models.SET_NULL, null=<span class="literal">True</span>,related_name=<span class="string">&quot;leader_department&quot;</span>, related_query_name=<span class="string">&quot;leader_department&quot;</span>)</span><br><span class="line">    <span class="comment"># manager: ä¸€å¯¹å¤šä½¿ç”¨å¤–é”®</span></span><br><span class="line">    manager = models.ForeignKey(OAUser, null=<span class="literal">True</span>, on_delete=models.SET_NULL,related_name=<span class="string">&quot;manager_departments&quot;</span>, related_query_name=<span class="string">&quot;manager_department&quot;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>å­—æ®µåè®²è§£:</strong></p>
<ul>
<li>name: å­—ç¬¦ä¸²ç±»å‹(æœ€å¤§é•¿åº¦ä¸º100)</li>
<li>intro: å­—ç¬¦ä¸²ç±»å‹(æœ€å¤§é•¿åº¦ä¸º200)</li>
<li>leader: ä¸€å¯¹ä¸€å­—æ®µç±»å‹(å¯ä¸ºç©º)</li>
<li>manager: ä¸€å¯¹å¤šå­—æ®µç±»å‹(å¯ä¸ºç©º)</li>
</ul>
</blockquote>
<h3 id="å…³è”Userä¸OADepartment"><a href="#å…³è”Userä¸OADepartment" class="headerlink" title="å…³è”Userä¸OADepartment"></a>å…³è”Userä¸OADepartment</h3><blockquote>
<p>æ­¤å¤„ï¼Œä¸ºäº†ç®€å•æ¼”ç¤ºï¼Œæ¯ä¸ªç”¨æˆ·åªéš¶å±äºä¸€ä¸ªéƒ¨é—¨ã€‚å¯ä»¥å°è¯•å°†éƒ¨é—¨çš„å­—æ®µç›´æ¥å®šä¹‰åœ¨Userè¡¨ä¸Šã€‚</p>
</blockquote>
<p>å› ä¸ºOADepartmentè¡¨å®šä¹‰åœ¨OAUseræ¨¡å‹ä¸‹æ–¹,æ­¤å¤„å¤–é”®å¼•ç”¨ä½¿ç”¨â€™OADepartmentâ€™å­—ç¬¦ä¸²å½¢å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">department = models.ForeignKey(<span class="string">&#x27;OADepartment&#x27;</span>, null=<span class="literal">True</span>,   on_delete=models.SET_NULL, related_name=<span class="string">&#x27;staffs&#x27;</span>, related_query_name=<span class="string">&quot;staffs&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Tips: å¦‚æœæœ‰æ—¶é—´ï¼Œå¯ä»¥åˆ›å»ºä¸€å¼ ä¸“é—¨ç”¨äºç”¨æˆ·å’Œéƒ¨é—¨ç»‘å®šå…³ç³»çš„è¡¨ã€‚è¿™ä¸ªå…³ç³»æ˜¯ä¸€ç§å¤šå¯¹å¤šçš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç”¨æˆ·å¯ä»¥éš¶å±äºå¤šä¸ªéƒ¨é—¨ã€‚</p>
</blockquote>
<h2 id="æ¨¡å‹æ˜ å°„"><a href="#æ¨¡å‹æ˜ å°„" class="headerlink" title="æ¨¡å‹æ˜ å°„"></a>æ¨¡å‹æ˜ å°„</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>
<p><em>æ£€æŸ¥æ•°æ®åº“ï¼ˆç¤ºä¾‹ï¼‰ï¼š</em><br><img src="https://s2.loli.net/2024/08/07/FAahlku9xcPtXUw.png"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬èŠ‚æ¦‚è¿°äº†OADepartmentæ¨¡å‹çš„è®¾è®¡ï¼ŒåŒ…æ‹¬å…¶å†…éƒ¨ç»“æ„å’Œä¸OAUseræ¨¡å‹çš„å…³è”ï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨æ•°æ®åº“çš„æ­£ç¡®æ˜ å°„ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-åç«¯ç™»å½•åŠŸèƒ½å®ç°(7)</title>
    <url>/2024/08/07/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E5%90%8E%E7%AB%AF%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0-7/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="ç™»å½•éªŒè¯æµç¨‹ï¼šä½¿ç”¨-Views-è§†å›¾å‡½æ•°è¿›è¡Œæ•°æ®æ ¡éªŒ"><a href="#ç™»å½•éªŒè¯æµç¨‹ï¼šä½¿ç”¨-Views-è§†å›¾å‡½æ•°è¿›è¡Œæ•°æ®æ ¡éªŒ" class="headerlink" title="ç™»å½•éªŒè¯æµç¨‹ï¼šä½¿ç”¨ Views è§†å›¾å‡½æ•°è¿›è¡Œæ•°æ®æ ¡éªŒ"></a>ç™»å½•éªŒè¯æµç¨‹ï¼šä½¿ç”¨ Views è§†å›¾å‡½æ•°è¿›è¡Œæ•°æ®æ ¡éªŒ</h2><h3 id="æ‰“å¼€-apps-oaauth-views-pyï¼Œå®šä¹‰è§†å›¾å‡½æ•°"><a href="#æ‰“å¼€-apps-oaauth-views-pyï¼Œå®šä¹‰è§†å›¾å‡½æ•°" class="headerlink" title="æ‰“å¼€ apps&#x2F;oaauth&#x2F;views.pyï¼Œå®šä¹‰è§†å›¾å‡½æ•°"></a>æ‰“å¼€ apps&#x2F;oaauth&#x2F;views.pyï¼Œå®šä¹‰è§†å›¾å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> rest_framework.views <span class="keyword">import</span> APIView</span><br><span class="line"><span class="keyword">from</span> apps.oaauth.serializers <span class="keyword">import</span> LoginSerializer, UserSerializer</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> .authentications <span class="keyword">import</span> generate_jwt</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> status</span><br><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="comment"># ç™»å½•åªèƒ½ç”¨postæ–¹æ³•å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="comment"># 1.éªŒè¯æ•°æ®æ˜¯å¦å¯ç”¨ï¼Œåœ¨æ­¤ä½¿ç”¨åºåˆ—åŒ–æ ¡éªŒæ•°æ®åº“ä¸å®¢æˆ·ç«¯å‘é€åˆ°æ•°æ®</span></span><br><span class="line">        serializer = LoginSerializer(data=request.data)</span><br><span class="line">        <span class="comment"># å¦‚æœéªŒè¯æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> serializer.is_valid():</span><br><span class="line">            <span class="comment"># é—´æ¥è·å–æ•°æ®åº“æ•°æ®ï¼ˆattrs[&#x27;user&#x27;] = userï¼‰</span></span><br><span class="line">            user = serializer.validated_data.get(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">            <span class="comment"># è®°å½•ä¸Šæ¬¡ç™»é™†çš„æ—¶é—´</span></span><br><span class="line">            user.last_login = datetime.now()</span><br><span class="line">            user.save()</span><br><span class="line">            <span class="comment"># ç™»é™†æˆåŠŸï¼Œç”Ÿæˆå¹¶è¿”å›JWT Token</span></span><br><span class="line">            token = generate_jwt(user)</span><br><span class="line">            <span class="keyword">return</span> Response(&#123;<span class="string">&#x27;token&#x27;</span>: token, <span class="string">&#x27;user&#x27;</span>: UserSerializer(user).data&#125;)</span><br><span class="line">        <span class="comment"># èº«ä»½éªŒè¯å¤±è´¥</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(serializer.errors)</span><br><span class="line">            <span class="keyword">return</span> Response(&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;å‚æ•°éªŒè¯å¤±è´¥ï¼&quot;</span>&#125;, status=status.HTTP_400_BAD_REQUEST)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>åœ¨å®šä¹‰ç™»å½•çš„è§†å›¾å‡½æ•°æ—¶ï¼Œèº«ä»½éªŒè¯æ˜¯ä¸€ä¸ªå…³é”®æ­¥éª¤ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨åºåˆ—åŒ–å™¨æ¥å¤„ç†æ•°æ®ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„åºåˆ—åŒ–å™¨æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚<br>åºåˆ—åŒ–å™¨: é€šè¿‡å®šä¹‰æ•°æ®æ¨¡å‹çš„è§„åˆ™å’ŒéªŒè¯é€»è¾‘ï¼Œç¡®ä¿æ¥æ”¶åˆ°çš„æ•°æ®ç¬¦åˆé¢„æœŸæ ¼å¼å¹¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚</strong></p>
</blockquote>
<h2 id="æ•°æ®éªŒè¯è‡ªåŠ¨åŒ–ï¼šSerializer-åºåˆ—åŒ–å™¨çš„åº”ç”¨"><a href="#æ•°æ®éªŒè¯è‡ªåŠ¨åŒ–ï¼šSerializer-åºåˆ—åŒ–å™¨çš„åº”ç”¨" class="headerlink" title="æ•°æ®éªŒè¯è‡ªåŠ¨åŒ–ï¼šSerializer åºåˆ—åŒ–å™¨çš„åº”ç”¨"></a>æ•°æ®éªŒè¯è‡ªåŠ¨åŒ–ï¼šSerializer åºåˆ—åŒ–å™¨çš„åº”ç”¨</h2><h3 id="å®šä¹‰-LoginSerializer-å¹¶å¯¹-validate-æ–¹æ³•è¿›è¡Œé‡å†™"><a href="#å®šä¹‰-LoginSerializer-å¹¶å¯¹-validate-æ–¹æ³•è¿›è¡Œé‡å†™" class="headerlink" title="å®šä¹‰ LoginSerializer å¹¶å¯¹ validate æ–¹æ³•è¿›è¡Œé‡å†™"></a>å®šä¹‰ LoginSerializer å¹¶å¯¹ validate æ–¹æ³•è¿›è¡Œé‡å†™</h3><p>åˆ›å»º apps&#x2F;oaauth&#x2F;serializers.py æ–‡ä»¶ï¼Œè‡ªå®šä¹‰åºåˆ—åŒ–å™¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> OAUser, UserStatusChoices, OADepartment</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginSerializer</span>(serializers.Serializer):</span><br><span class="line">    <span class="comment"># å®šä¹‰éœ€è¦éªŒè¯çš„å­—æ®µ</span></span><br><span class="line">    email = serializers.EmailField(required=<span class="literal">True</span>)  <span class="comment"># ç”µå­é‚®ç®±å­—æ®µï¼Œå¿…å¡«ï¼ŒéªŒè¯ä¸ºæœ‰æ•ˆçš„é‚®ç®±æ ¼å¼</span></span><br><span class="line">    password = serializers.CharField(max_length=<span class="number">20</span>, min_length=<span class="number">6</span>)  <span class="comment"># å¯†ç å­—æ®µï¼Œå¿…å¡«ï¼Œè¦æ±‚æœ€å°‘6ä¸ªå­—ç¬¦ä¸”æœ€å¤š20ä¸ªå­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é‡å†™validateæ–¹æ³•ï¼Œä»¥å®ç°è‡ªå®šä¹‰æ ¡éªŒåŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">validate</span>(<span class="params">self, attrs</span>):</span><br><span class="line">        <span class="comment"># attrs åŒ…å« email å’Œ password æ•°æ®ï¼Œä»ä¸­è·å–è¿™äº›æ•°æ®</span></span><br><span class="line">        email = attrs.get(<span class="string">&#x27;email&#x27;</span>)</span><br><span class="line">        password = attrs.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># éªŒè¯æˆåŠŸçš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> email <span class="keyword">and</span> password:</span><br><span class="line">            <span class="comment"># æ ¹æ® email æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">            user = OAUser.objects.<span class="built_in">filter</span>(email=email).first()  <span class="comment"># å°è¯•è·å–å¯¹åº”é‚®ç®±çš„ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">            <span class="comment"># æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> user:</span><br><span class="line">                <span class="comment"># å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼ŒæŠ›å‡ºéªŒè¯é”™è¯¯</span></span><br><span class="line">                <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&quot;è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç”¨æˆ·å­˜åœ¨ï¼Œæ ¡éªŒå¯†ç </span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> user.check_password(password):  <span class="comment"># ä½¿ç”¨ Django è‡ªå¸¦çš„æ–¹æ³•æ£€æŸ¥å¯†ç </span></span><br><span class="line">                <span class="comment"># å¦‚æœå¯†ç ä¸æ­£ç¡®ï¼ŒæŠ›å‡ºéªŒè¯é”™è¯¯</span></span><br><span class="line">                <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&quot;è¯·è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ¤æ–­ç”¨æˆ·çŠ¶æ€æ˜¯å¦å¯ç”¨</span></span><br><span class="line">            <span class="keyword">if</span> user.status == UserStatusChoices.UNACTIVE:  <span class="comment"># ç”¨æˆ·çŠ¶æ€ä¸ºæœªæ¿€æ´»</span></span><br><span class="line">                <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&quot;è¯¥ç”¨æˆ·å°šæœªæ¿€æ´»&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> user.status == UserStatusChoices.LOCKED:  <span class="comment"># ç”¨æˆ·çŠ¶æ€ä¸ºé”å®š</span></span><br><span class="line">                <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&quot;è¯¥è´¦å·å·²è¢«é”å®šï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è§†å›¾å‡½æ•°ä¸­è¿˜ä¼šåšç™»å½•æ“ä½œï¼Œä¸ºäº†èŠ‚çœæ‰§è¡Œ SQL è¯­å¥çš„æ¬¡æ•°ï¼Œå°†ç”¨æˆ·å¯¹è±¡ç›´æ¥æ”¾å…¥ attrs ä¸­ï¼Œæ–¹ä¾¿åœ¨è§†å›¾ä¸­ä½¿ç”¨</span></span><br><span class="line">            attrs[<span class="string">&#x27;user&#x27;</span>] = user</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœæ²¡æœ‰æä¾›é‚®ç®±æˆ–å¯†ç ï¼ŒæŠ›å‡ºéªŒè¯é”™è¯¯</span></span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(<span class="string">&quot;è¯·ä¼ å…¥é‚®ç®±å’Œå¯†ç ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿”å›åŒ…å«éªŒè¯åæ•°æ®çš„å­—å…¸</span></span><br><span class="line">        <span class="keyword">return</span> attrs</span><br></pre></td></tr></table></figure>

<h3 id="åºåˆ—åŒ–æ¨¡å‹å®šä¹‰ä¸æ¨¡å‹åµŒå¥—"><a href="#åºåˆ—åŒ–æ¨¡å‹å®šä¹‰ä¸æ¨¡å‹åµŒå¥—" class="headerlink" title="åºåˆ—åŒ–æ¨¡å‹å®šä¹‰ä¸æ¨¡å‹åµŒå¥—"></a>åºåˆ—åŒ–æ¨¡å‹å®šä¹‰ä¸æ¨¡å‹åµŒå¥—</h3><p><em>ä»£ç ç»­å†™å¦‚ä¸‹ï¼ˆç¤ºä¾‹ï¼‰ï¼š</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»§æ‰¿ModelSerializeræ¨¡å‹, é¿å…é‡å¤å®šä¹‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DepartmentSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = OADepartment</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="comment"># é‡å†™department</span></span><br><span class="line">    department = DepartmentSerializer()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = OAUser</span><br><span class="line">        <span class="comment"># fields = &quot;__all__&quot;</span></span><br><span class="line">        <span class="comment"># æ’é™¤ä¸éœ€è¦è¿”å›çš„å­—æ®µ(é‡è¦ä¿¡æ¯ä»¥åŠæ— éœ€è¿”å›çš„æ•°æ®)</span></span><br><span class="line">        exclude = (<span class="string">&quot;password&quot;</span>, <span class="string">&quot;groups&quot;</span>, <span class="string">&quot;user_permissions&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="JWT-Token-æƒé™è®¤è¯"><a href="#JWT-Token-æƒé™è®¤è¯" class="headerlink" title="JWT Token æƒé™è®¤è¯"></a>JWT Token æƒé™è®¤è¯</h2><h3 id="åˆ›å»º-apps-oaauth-authentications-py-æ–‡ä»¶"><a href="#åˆ›å»º-apps-oaauth-authentications-py-æ–‡ä»¶" class="headerlink" title="åˆ›å»º apps\oaauth\ authentications.py æ–‡ä»¶"></a><span style="color:red">åˆ›å»º</span> apps\oaauth\ <span style="color:red">authentications.py æ–‡ä»¶</span></h3><blockquote>
<p>ä½¿ç”¨ JWT Token è¿›è¡ŒéªŒè¯çš„å¥½å¤„åœ¨äºå®ƒæä¾›äº†ä¸€ç§è‡ªåŒ…å«ã€å®‰å…¨ä¸”æ˜“äºåœ¨ä¸åŒæœåŠ¡é—´ä¼ é€’ç”¨æˆ·èº«ä»½ä¿¡æ¯çš„æ–¹å¼ï¼ŒåŒæ—¶å‡å°‘äº†å¯¹æœåŠ¡å™¨çš„ä¾èµ–ï¼Œæé«˜äº†ç³»ç»Ÿçš„æ‰©å±•æ€§å’Œå“åº”é€Ÿåº¦ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">from</span> rest_framework.authentication <span class="keyword">import</span> BaseAuthentication, get_authorization_header</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> exceptions</span><br><span class="line"><span class="keyword">from</span> jwt.exceptions <span class="keyword">import</span> ExpiredSignatureError</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> OAUser</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_jwt</span>(<span class="params">user</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”ŸæˆJWT Tokenï¼Œç”¨äºèº«ä»½éªŒè¯ã€‚</span></span><br><span class="line"><span class="string">    å‚æ•°:</span></span><br><span class="line"><span class="string">    user (OAUser): å½“å‰ç™»å½•çš„ç”¨æˆ·å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ç»è¿‡èº«ä»½éªŒè¯åçš„ç”¨æˆ·</span></span><br><span class="line"><span class="string">    è¿”å›:</span></span><br><span class="line"><span class="string">    str: ç”Ÿæˆçš„JWT Tokenï¼Œè¿™ä¸ªTokenåŒ…å«ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†å’Œè¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è®¾ç½®Tokençš„è¿‡æœŸæ—¶é—´ä¸º7å¤©å</span></span><br><span class="line">    expire_time = time.time() + <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span></span><br><span class="line">    <span class="comment"># åˆ›å»ºJWT Tokenï¼ŒåŒ…å«ç”¨æˆ·IDå’Œè¿‡æœŸæ—¶é—´ï¼Œä½¿ç”¨SECRET_KEYè¿›è¡Œç­¾å</span></span><br><span class="line">    <span class="keyword">return</span> jwt.encode(&#123;<span class="string">&#x27;userid&#x27;</span>: user.pk, <span class="string">&#x27;exp&#x27;</span>: expire_time&#125;, key=settings.SECRET_KEY, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JWTAuthentication</span>(<span class="title class_ inherited__">BaseAuthentication</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è‡ªå®šä¹‰JWTè®¤è¯ç±»ï¼Œç”¨äºåœ¨Django REST Frameworkä¸­è¿›è¡ŒJWTè®¤è¯ã€‚</span></span><br><span class="line"><span class="string">    è¿™ä¸ªç±»å°†å¤„ç†ä»è¯·æ±‚ä¸­æå–JWTï¼ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ï¼Œå¹¶è¿”å›å¯¹åº”çš„ç”¨æˆ·å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    keyword = <span class="string">&#x27;JWT&#x27;</span>  <span class="comment"># è®¤è¯å¤´éƒ¨å…³é”®å­—ï¼Œé€šå¸¸æ˜¯&#x27;JWT&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">authentication</span>(<span class="params">self, request</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ä»è¯·æ±‚å¯¹è±¡ä¸­æå–å¹¶éªŒè¯JWT Tokenï¼Œä»¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚</span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">        request (HttpRequest): HTTPè¯·æ±‚å¯¹è±¡ï¼Œå¯ä»¥æ˜¯æ¥è‡ªå®¢æˆ·ç«¯çš„HTTPè¯·æ±‚</span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">        tuple: (user, token) ç”¨æˆ·å¯¹è±¡å’ŒJWT Tokenï¼Œå¦‚æœè®¤è¯å¤±è´¥åˆ™è¿”å›None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># ä»è¯·æ±‚å¤´ä¸­è·å–Authorizationå­—æ®µï¼Œå¹¶æŒ‰ç©ºæ ¼åˆ†å‰²</span></span><br><span class="line">        auth = get_authorization_header(request).split()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥Authorizationå¤´éƒ¨æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å¦ä»¥&#x27;JWT&#x27;å…³é”®å­—å¼€å¤´</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> auth <span class="keyword">or</span> auth[<span class="number">0</span>].lower() != <span class="variable language_">self</span>.keyword.lower().encode():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># è®¤è¯å¤±è´¥ï¼Œè¿”å›None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥Tokençš„æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æœ‰ä¸”åªæœ‰ä¸€ä¸ªToken</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(auth) == <span class="number">1</span>:</span><br><span class="line">            msg = <span class="string">&#x27;ä¸å¯ç”¨çš„JWTè¯·æ±‚å¤´ï¼&#x27;</span>  <span class="comment"># Tokenç¼ºå¤±ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)  <span class="comment"># æŠ›å‡ºè®¤è¯å¤±è´¥å¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(auth) &gt; <span class="number">2</span>:</span><br><span class="line">            msg = <span class="string">&#x27;ä¸å¯ç”¨çš„JWTè¯·æ±‚å¤´ï¼JWT Tokenä¸­é—´ä¸åº”è¯¥æœ‰ç©ºæ ¼ï¼&#x27;</span>  <span class="comment"># TokenåŒ…å«å¤šä½™çš„ç©ºæ ¼</span></span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)  <span class="comment"># æŠ›å‡ºè®¤è¯å¤±è´¥å¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æå–Tokenå¹¶è§£ç </span></span><br><span class="line">            jwt_token = auth[<span class="number">1</span>]</span><br><span class="line">            <span class="comment"># ä½¿ç”¨SECRET_KEYè§£ç Token</span></span><br><span class="line">            jwt_info = jwt.decode(jwt_token, settings.SECRET_KEY, algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">            userid = jwt_info[<span class="string">&#x27;userid&#x27;</span>]  <span class="comment"># è·å–ç”¨æˆ·ID</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ ¹æ®ç”¨æˆ·IDæŸ¥æ‰¾ç”¨æˆ·ï¼Œç¡®ä¿ç”¨æˆ·å­˜åœ¨</span></span><br><span class="line">                user = OAUser.objects.get(pk=userid)</span><br><span class="line">                <span class="built_in">setattr</span>(request, <span class="string">&#x27;user&#x27;</span>, user)  <span class="comment"># å°†ç”¨æˆ·å¯¹è±¡ç»‘å®šåˆ°requestä¸Šï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨</span></span><br><span class="line">                <span class="keyword">return</span> user, jwt_token  <span class="comment"># è¿”å›ç”¨æˆ·å¯¹è±¡å’ŒJWT Token</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> OAUser.DoesNotExist:</span><br><span class="line">                msg = <span class="string">&quot;JWT Tokenå¯¹åº”çš„ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>  <span class="comment"># å¦‚æœæ‰¾ä¸åˆ°ç”¨æˆ·ID</span></span><br><span class="line">                <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)  <span class="comment"># æŠ›å‡ºè®¤è¯å¤±è´¥å¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> ExpiredSignatureError:</span><br><span class="line">            msg = <span class="string">&quot;JWT Tokenå·²è¿‡æœŸï¼&quot;</span>  <span class="comment"># å¤„ç†Tokenè¿‡æœŸæƒ…å†µ</span></span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)  <span class="comment"># æŠ›å‡ºè®¤è¯å¤±è´¥å¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> jwt.DecodeError:</span><br><span class="line">            msg = <span class="string">&quot;æ— æ•ˆçš„JWT Token&quot;</span>  <span class="comment"># Tokenè§£ç å¤±è´¥</span></span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)  <span class="comment"># æŠ›å‡ºè®¤è¯å¤±è´¥å¼‚å¸¸</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><span style="color:purple">(à¹‘â€¢Ì€ã…‚â€¢Ì) âœ§ </span> <span style="color:pink;">ç‚¹èµåŠ æ”¶è—çªç ´ 100ï¼Œé¢å¤–åŠ æ›´ä¸€æœŸ JWT Token æƒé™è®¤è¯ç³»åˆ—æ–‡ç« !!!</span></p>
</blockquote>
<h2 id="è·¯ç”±æ˜ å°„"><a href="#è·¯ç”±æ˜ å°„" class="headerlink" title="è·¯ç”±æ˜ å°„"></a>è·¯ç”±æ˜ å°„</h2><h3 id="åˆ›å»º-apps-oaauth-urls-py-æ–‡ä»¶"><a href="#åˆ›å»º-apps-oaauth-urls-py-æ–‡ä»¶" class="headerlink" title="åˆ›å»º apps\oaauth\ urls.py æ–‡ä»¶"></a><span style="color:red">åˆ›å»º</span> apps\oaauth\ <span style="color:red">urls.py æ–‡ä»¶</span></h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"><span class="comment"># åº”ç”¨å‘½åç©ºé—´</span></span><br><span class="line">app_name = <span class="string">&#x27;oaauth&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># .as_view() æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ¥å—è¯·æ±‚å‚æ•°çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œè¿™æ · Django å°±å¯ä»¥æ­£ç¡®åœ°å°†è¯·æ±‚åˆ†æ´¾ç»™ç±»è§†å›¾çš„æ–¹æ³•</span></span><br><span class="line">    path(<span class="string">&#x27;login&#x27;</span>,views.LoginView.as_view(),name=<span class="string">&#x27;login&#x27;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="é¡¹ç›®æ ¹ç›®å½•æ·»åŠ å­è·¯ç”±"><a href="#é¡¹ç›®æ ¹ç›®å½•æ·»åŠ å­è·¯ç”±" class="headerlink" title="é¡¹ç›®æ ¹ç›®å½•æ·»åŠ å­è·¯ç”±"></a>é¡¹ç›®æ ¹ç›®å½•æ·»åŠ å­è·¯ç”±</h3><p>æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•çš„ oaback\urls.py æ–‡ä»¶ï¼Œæ·»åŠ å­è·¯ç”±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&quot;admin/&quot;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&quot;auth/&quot;</span>,include(<span class="string">&#x27;apps.oaauth.urls&#x27;</span>))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="Postman-æµ‹è¯•"><a href="#Postman-æµ‹è¯•" class="headerlink" title="Postman æµ‹è¯•"></a>Postman æµ‹è¯•</h2><h3 id="éªŒè¯-å¤±è´¥æƒ…å†µç¤ºä¾‹"><a href="#éªŒè¯-å¤±è´¥æƒ…å†µç¤ºä¾‹" class="headerlink" title="éªŒè¯:å¤±è´¥æƒ…å†µç¤ºä¾‹"></a>éªŒè¯:å¤±è´¥æƒ…å†µç¤ºä¾‹</h3><p><img src="https://s2.loli.net/2024/08/07/G26jz1QbTLwB8tU.png"></p>
<h3 id="éªŒè¯-æˆåŠŸæƒ…å†µç¤ºä¾‹"><a href="#éªŒè¯-æˆåŠŸæƒ…å†µç¤ºä¾‹" class="headerlink" title="éªŒè¯:æˆåŠŸæƒ…å†µç¤ºä¾‹"></a>éªŒè¯:æˆåŠŸæƒ…å†µç¤ºä¾‹</h3><p><img src="https://s2.loli.net/2024/08/07/J5qEuWcovhbOHVP.png"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</span></h2><p>æœ¬èŠ‚å†…å®¹æˆåŠŸå®ç°äº†åç«¯çš„ç™»å½•å’Œèº«ä»½éªŒè¯åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ Postman å·¥å…·è¿›è¡Œäº†å…¨é¢çš„æµ‹è¯•éªŒè¯ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-ä¿®æ”¹OAUseræ¨¡å‹ä¸»é”®(4)</title>
    <url>/2024/08/07/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E4%BF%AE%E6%94%B9OAUser%E6%A8%A1%E5%9E%8B%E4%B8%BB%E9%94%AE-4/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h2><h3 id="shortuuid"><a href="#shortuuid" class="headerlink" title="shortuuid"></a><a href="https://pypi.org/project/shortuuid/">shortuuid</a></h3><blockquote>
<p>ä½¿ç”¨ shortuuid å¯ä»¥ç”ŸæˆçŸ­å°ã€å”¯ä¸€ã€éšæœºçš„æ ‡è¯†ç¬¦ï¼Œä¸ºæ•°æ®åº“æä¾›è·¨å¹³å°å…¼å®¹æ€§ã€å¢å¼ºéšç§æ€§ã€å‡å°‘å­˜å‚¨ç©ºé—´å’Œé¿å… ID å†²çªç­‰ä¼˜åŠ¿ï¼Œæ¯”é»˜è®¤ç”Ÿæˆçš„è‡ªåŠ¨å¢é•¿çš„ id æ›´å…·æœ‰å®‰å…¨æ€§ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install shortuuid</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/08/07/IBsHu3wcfhrEd8b.png"></p>
<h3 id="django-shortuuidfield"><a href="#django-shortuuidfield" class="headerlink" title="django-shortuuidfield"></a><a href="https://pypi.org/project/django-shortuuidfield/">django-shortuuidfield</a></h3><blockquote>
<p>django-shortuuidfield æ˜¯ä¸€ä¸ª Django åº”ç”¨ç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äº Django æ¨¡å‹çš„ ShortUUIDField å­—æ®µï¼Œè¯¥å­—æ®µä½¿ç”¨ shortuuid åº“æ¥ç”ŸæˆçŸ­å°ä¸”å”¯ä¸€çš„ UUIDã€‚<br>Tips:æ­¤é¡¹ç›®ä½¿ç”¨ django-shortuuidfieldï¼Œå·²åŒ…å« uuid åº“æ— éœ€å•&gt;ç‹¬ä¸‹è½½ shortuuidã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install django-shortuuidfield</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/08/07/fLZ1B5qjAOtvRrh.png"></p>
<h2 id="é…ç½®-ShortUUIDField"><a href="#é…ç½®-ShortUUIDField" class="headerlink" title="é…ç½® ShortUUIDField"></a>é…ç½® ShortUUIDField</h2><h3 id="ä»-shortuuidfield-ä¸­å¯¼å…¥-ShortUUIDField"><a href="#ä»-shortuuidfield-ä¸­å¯¼å…¥-ShortUUIDField" class="headerlink" title="ä» shortuuidfield ä¸­å¯¼å…¥ ShortUUIDField"></a>ä» shortuuidfield ä¸­å¯¼å…¥ ShortUUIDField</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> shortuuidfield <span class="keyword">import</span> ShortUUIDField</span><br></pre></td></tr></table></figure>

<h3 id="æ·»åŠ è‡³-OAUser-æ¨¡å‹"><a href="#æ·»åŠ è‡³-OAUser-æ¨¡å‹" class="headerlink" title="æ·»åŠ è‡³ OAUser æ¨¡å‹"></a>æ·»åŠ è‡³ OAUser æ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">uid = ShortUUIDField(primary_key=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="é‡å»ºæ•°æ®åº“"><a href="#é‡å»ºæ•°æ®åº“" class="headerlink" title="é‡å»ºæ•°æ®åº“"></a>é‡å»ºæ•°æ®åº“</h2><blockquote>
<p>ç”±äºä¸»é”®çš„æ›´æ”¹ä¼šå¯¹æ•°æ®åº“ç»“æ„äº§ç”Ÿé‡å¤§å½±å“ï¼Œç›´æ¥è¿›è¡Œè¿ç§»å¯èƒ½ä¼šå¯¼è‡´ä¾èµ–äº User è¡¨çš„å…¶ä»–è¡¨å‡ºç°æ•…éšœã€‚å› æ­¤ï¼Œéœ€è¦å…ˆåˆ é™¤æ‰€æœ‰å¼•ç”¨äº† User è¡¨çš„è¡¨ï¼Œç„¶åå†é‡æ–°ç”Ÿæˆè¿™äº›è¡¨ä»¥ç¡®ä¿æ•°æ®åº“çš„ä¸€è‡´æ€§å’ŒåŠŸèƒ½çš„å®Œæ•´æ€§ã€‚</p>
</blockquote>
<h3 id="MySQL-é‡å»ºæ•°æ®åº“-oa"><a href="#MySQL-é‡å»ºæ•°æ®åº“-oa" class="headerlink" title="MySQL é‡å»ºæ•°æ®åº“ oa"></a>MySQL é‡å»ºæ•°æ®åº“ oa</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> oa;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE oa <span class="keyword">DEFAULT</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤æ®‹ç•™è¿ç§»æ–‡ä»¶"><a href="#åˆ é™¤æ®‹ç•™è¿ç§»æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ®‹ç•™è¿ç§»æ–‡ä»¶"></a>åˆ é™¤æ®‹ç•™è¿ç§»æ–‡ä»¶</h3><p>è¿ç§»æ–‡ä»¶ä½äº: appsâ€“&gt;oaauthâ€“&gt;migrationsâ€“&gt;0001_initial.py<br><img src="https://s2.loli.net/2024/08/07/2FWNKqiZvfQX7lY.png"></p>
<h2 id="æ¨¡å‹æ˜ å°„"><a href="#æ¨¡å‹æ˜ å°„" class="headerlink" title="æ¨¡å‹æ˜ å°„"></a>æ¨¡å‹æ˜ å°„</h2><p><em>ç»ˆç«¯ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹ï¼ˆç¤ºä¾‹ï¼‰ï¼š</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<p><em>æ£€æŸ¥æ•°æ®åº“ï¼ˆç¤ºä¾‹ï¼‰ï¼š</em><br><img src="https://s2.loli.net/2024/08/07/a4DPKuHkA6gphOz.png"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬èŠ‚ä»‹ç»äº†é€šè¿‡å®‰è£… django-shortuuidfieldï¼Œå®ç°æ•°æ®åº“çš„é‡æ–°åˆå§‹åŒ–å’Œæ¨¡å‹è¿ç§»ï¼Œä»¥ UUID å¢å¼ºå®é™…æƒ…å†µä¸‹ä¼ä¸šçš„ä¿¡æ¯å®‰å…¨ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-è‡ªå®šä¹‰å‘½ä»¤åˆå§‹åŒ–(6)</title>
    <url>/2024/08/07/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E5%88%9D%E5%A7%8B%E5%8C%96-6/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h2 id="åˆå§‹åŒ–é…ç½®"><a href="#åˆå§‹åŒ–é…ç½®" class="headerlink" title="åˆå§‹åŒ–é…ç½®"></a>åˆå§‹åŒ–é…ç½®</h2><p>ä¸ºäº†ç¡®ä¿å‘½ä»¤è¡Œå·¥å…·åœ¨åº”ç”¨ç¨‹åºä¸­æœ‰æ•ˆè¿è¡Œï¼Œå¿…é¡»å…ˆå®‰è£…åº”ç”¨ç¨‹åºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&quot;django.contrib.admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.auth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.contenttypes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.staticfiles&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£…rest_framework</span></span><br><span class="line">    <span class="string">&#x27;rest_framework&#x27;</span>,</span><br><span class="line">    <span class="comment"># å®‰è£…django-cors-headers</span></span><br><span class="line">    <span class="string">&#x27;corsheaders&#x27;</span>,</span><br><span class="line">    <span class="comment"># å®‰è£…oaauthåº”ç”¨</span></span><br><span class="line">    <span class="string">&#x27;apps.oaauth&#x27;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹æ˜¯åˆ›å»ºå‘½ä»¤è¡Œå·¥å…·çš„æ­¥éª¤ï¼š</p>
<blockquote>
<ol>
<li>åœ¨åº”ç”¨ç¨‹åºçš„ oaauth æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º management çš„ Python åŒ…ã€‚ç¡®ä¿åŒ…å« <strong>init</strong>.py æ–‡ä»¶ï¼Œè¿™æ˜¯ Python è¯†åˆ«è¯¥ç›®å½•ä¸ºåŒ…çš„å¿…è¦æ–‡ä»¶ã€‚</li>
<li>åœ¨ management åŒ…å†…ï¼Œè¿›ä¸€æ­¥åˆ›å»ºä¸€ä¸ªåä¸º commands çš„å­åŒ…ã€‚</li>
<li>åœ¨ commands åŒ…ä¸­ï¼Œæ ¹æ®æ‚¨çš„å‘½ä»¤åŠŸèƒ½ï¼Œåˆ›å»ºç›¸åº”çš„ Python è„šæœ¬æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶çš„åç§°å°†ç›´æ¥æ˜ å°„ä¸ºå¯æ‰§è¡Œçš„å‘½ä»¤åç§°ã€‚</li>
</ol>
</blockquote>
<blockquote>
<p><strong>Tips:</strong></p>
<ul>
<li>å‘½ä»¤çš„æ‰§è¡Œä¾èµ–äºåº”ç”¨ç¨‹åºçš„å®‰è£…çŠ¶æ€ï¼Œå³è‡ªå®šä¹‰å‘½ä»¤çš„åç§°ä¸ºæ–‡ä»¶åç§°ã€‚</li>
<li>ç¡®ä¿æ¯ä¸ªåŒ…éƒ½éµå¾ª Python çš„åŒ…ç»“æ„è§„èŒƒï¼ŒåŒ…å«å¿…è¦çš„<code>__init__.py</code> æ–‡ä»¶ã€‚<br><span style="color:oklch(90% 0.4 240); display:flex; justify-content:center;">â€”ä»¥ä¸Šå‡ä¸ºå›ºå®šå†™æ³•â€”</span></li>
</ul>
</blockquote>
<p>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼ˆç¤ºä¾‹ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â”œâ”€apps</span><br><span class="line">â”‚  â”‚  __init__.py</span><br><span class="line">â”‚  â”‚</span><br><span class="line">â”‚  â”œâ”€oaauth</span><br><span class="line">â”‚  â”‚  â”‚</span><br><span class="line">â”‚  â”‚  â”œâ”€management</span><br><span class="line">â”‚  â”‚  â”‚  â”‚  __init__.py</span><br><span class="line">â”‚  â”‚  â”‚  â”‚</span><br><span class="line">â”‚  â”‚  â”‚  â”œâ”€commands</span><br><span class="line">â”‚  â”‚  â”‚  â”‚  â”‚  initdepartments.py</span><br><span class="line">â”‚  â”‚  â”‚  â”‚  â”‚  inituser.py</span><br><span class="line">â”‚  â”‚  â”‚  â”‚  â”‚  __init__.py</span><br></pre></td></tr></table></figure>

<h2 id="åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"><a href="#åˆå§‹åŒ–éƒ¨é—¨æ•°æ®" class="headerlink" title="åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"></a>åˆå§‹åŒ–éƒ¨é—¨æ•°æ®</h2><h3 id="åœ¨åˆ›å»ºçš„-initdepartments-py-æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"><a href="#åœ¨åˆ›å»ºçš„-initdepartments-py-æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®" class="headerlink" title="åœ¨åˆ›å»ºçš„ initdepartments.py æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"></a>åœ¨åˆ›å»ºçš„ initdepartments.py æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.management.base <span class="keyword">import</span> BaseCommand</span><br><span class="line"><span class="keyword">from</span> apps.oaauth.models <span class="keyword">import</span> OADepartment</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Command</span>(<span class="title class_ inherited__">BaseCommand</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self,*args, **options</span>):</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–éƒ¨é—¨æ•°æ®</span></span><br><span class="line">        boarder = OADepartment.objects.create(name=<span class="string">&#x27;è‘£äº‹ä¼š&#x27;</span>, intro=<span class="string">&#x27;è‘£äº‹ä¼š&#x27;</span>)</span><br><span class="line">        developer = OADepartment.objects.create(name=<span class="string">&#x27;äº§å“å¼€å‘éƒ¨&#x27;</span>, intro=<span class="string">&#x27;äº§å“è®¾è®¡ï¼ŒæŠ€æœ¯å¼€å‘&#x27;</span>)</span><br><span class="line">        operator = OADepartment.objects.create(name=<span class="string">&#x27;è¿è¥éƒ¨&#x27;</span>, intro=<span class="string">&#x27;å®¢æˆ·è¿è¥ï¼Œäº§å“è¿è¥&#x27;</span>)</span><br><span class="line">        saler = OADepartment.objects.create(name=<span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>, intro=<span class="string">&#x27;é”€å”®äº§å“&#x27;</span>)</span><br><span class="line">        hr = OADepartment.objects.create(name=<span class="string">&#x27;äººäº‹éƒ¨&#x27;</span>, intro=<span class="string">&#x27;å‘˜å·¥æ‹›è˜ï¼Œå‘˜å·¥åŸ¹è®­ï¼Œå‘˜å·¥è€ƒæ ¸&#x27;</span>)</span><br><span class="line">        finance = OADepartment.objects.create(name=<span class="string">&#x27;è´¢åŠ¡éƒ¨&#x27;</span>, intro=<span class="string">&#x27;è´¢åŠ¡æŠ¥è¡¨ï¼Œè´¢åŠ¡å®¡æ ¸&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.stdout.write(<span class="string">&#x27;éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸï¼&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®Œæˆç¼–å†™åï¼Œæ— éœ€æ‰‹åŠ¨ä¿å­˜ã€‚create æ–¹æ³•å·²è‡ªåŠ¨å°†æ•°æ®åŒæ­¥è‡³æ•°æ®åº“ã€‚</p>
</blockquote>
<h3 id="ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“"><a href="#ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“" class="headerlink" title="ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“"></a>ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py initdepartments</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ç»ˆç«¯å°†ä¼šè¾“å‡º <strong>éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸï¼</strong></p>
<h3 id="æ£€æŸ¥æ•°æ®åº“-éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸ"><a href="#æ£€æŸ¥æ•°æ®åº“-éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸ" class="headerlink" title="æ£€æŸ¥æ•°æ®åº“:éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸ"></a>æ£€æŸ¥æ•°æ®åº“:éƒ¨é—¨æ•°æ®åˆå§‹åŒ–æˆåŠŸ</h3><p><img src="https://s2.loli.net/2024/08/07/dhszHeOig1x3lZj.png"></p>
<h2 id="åˆå§‹åŒ–ç”¨æˆ·æ•°æ®"><a href="#åˆå§‹åŒ–ç”¨æˆ·æ•°æ®" class="headerlink" title="åˆå§‹åŒ–ç”¨æˆ·æ•°æ®"></a>åˆå§‹åŒ–ç”¨æˆ·æ•°æ®</h2><h3 id="åœ¨åˆ›å»ºçš„-inituser-py-æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"><a href="#åœ¨åˆ›å»ºçš„-inituser-py-æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®" class="headerlink" title="åœ¨åˆ›å»ºçš„ inituser.py æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®"></a>åœ¨åˆ›å»ºçš„ inituser.py æ–‡ä»¶ä¸­ï¼Œé…ç½®åˆå§‹åŒ–éƒ¨é—¨æ•°æ®</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.management.base <span class="keyword">import</span> BaseCommand</span><br><span class="line"><span class="keyword">from</span> apps.oaauth.models <span class="keyword">import</span> OAUser, OADepartment</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Command</span>(<span class="title class_ inherited__">BaseCommand</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self, *args, **options</span>):</span><br><span class="line">        boarder = OADepartment.objects.get(name=<span class="string">&#x27;è‘£äº‹ä¼š&#x27;</span>)</span><br><span class="line">        developer = OADepartment.objects.get(name=<span class="string">&#x27;äº§å“å¼€å‘éƒ¨&#x27;</span>)</span><br><span class="line">        operator = OADepartment.objects.get(name=<span class="string">&#x27;è¿è¥éƒ¨&#x27;</span>)</span><br><span class="line">        saler = OADepartment.objects.get(name=<span class="string">&#x27;é”€å”®éƒ¨&#x27;</span>)</span><br><span class="line">        hr = OADepartment.objects.get(name=<span class="string">&#x27;äººäº‹éƒ¨&#x27;</span>)</span><br><span class="line">        finance = OADepartment.objects.get(name=<span class="string">&#x27;è´¢åŠ¡éƒ¨&#x27;</span>)</span><br><span class="line">        <span class="comment"># è‘£äº‹ä¼šçš„å‘˜å·¥,éƒ½æ˜¯superuserç”¨æˆ·</span></span><br><span class="line">        <span class="comment"># 1. ä¸œä¸œï¼šå±äºè‘£äº‹ä¼šçš„leader</span></span><br><span class="line">        dongdong = OAUser.objects.create_superuser(email=<span class="string">&quot;dongdong@qq.com&quot;</span>,realname=<span class="string">&quot;ä¸œä¸œ&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=boarder)</span><br><span class="line">        <span class="comment"># 2. å¤šå¤šï¼šè‘£äº‹ä¼š</span></span><br><span class="line">        duoduo = OAUser.objects.create_superuser(email=<span class="string">&quot;duoduo@qq.com&quot;</span>,realname=<span class="string">&quot;å¤šå¤š&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=boarder)</span><br><span class="line">        <span class="comment"># 3. å¼ ä¸‰ï¼šäº§å“å¼€å‘éƒ¨çš„leader</span></span><br><span class="line">        zhangsan = OAUser.objects.create_user(email=<span class="string">&quot;zhangsan@qq.com&quot;</span>,realname=<span class="string">&quot;å¼ ä¸‰&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=developer)</span><br><span class="line">        <span class="comment"># 4.æå››ï¼šè¿è¥éƒ¨çš„leader</span></span><br><span class="line">        lisi = OAUser.objects.create_user(email=<span class="string">&quot;lisi@qq.com&quot;</span>,realname=<span class="string">&quot;æå››&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=operator)</span><br><span class="line">        <span class="comment"># 5. ç‹äº”ï¼šäººäº‹éƒ¨çš„leader</span></span><br><span class="line">        wangwu = OAUser.objects.create_user(email=<span class="string">&quot;wangwu@qq.com&quot;</span>,realname=<span class="string">&quot;ç‹äº”&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=hr)</span><br><span class="line">        <span class="comment"># 6. èµµå…­ï¼šè´¢åŠ¡éƒ¨çš„leader</span></span><br><span class="line">        zhaoliu = OAUser.objects.create_user(email=<span class="string">&quot;zhaoliu@qq.com&quot;</span>,realname=<span class="string">&quot;èµµå…­&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=finance)</span><br><span class="line">        <span class="comment"># 7. å­™ä¸ƒï¼šé”€å”®éƒ¨çš„leader</span></span><br><span class="line">        sunqi = OAUser.objects.create_user(email=<span class="string">&quot;sunqi@qq.com&quot;</span>,realname=<span class="string">&quot;å­™ä¸ƒ&quot;</span>,password=<span class="string">&quot;111111&quot;</span>,department=saler)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç»™éƒ¨é—¨æŒ‡å®šleaderå’Œmanager</span></span><br><span class="line">        <span class="comment"># 1. è‘£äº‹ä¼š</span></span><br><span class="line">        boarder.leader = dongdong</span><br><span class="line">        boarder.manager = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2.äº§å“å¼€å‘éƒ¨</span></span><br><span class="line">        developer.leader = zhangsan</span><br><span class="line">        developer.manager = dongdong</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3.è¿è¥éƒ¨</span></span><br><span class="line">        operator.leader = lisi</span><br><span class="line">        operator.manager = dongdong</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4.é”€å”®éƒ¨</span></span><br><span class="line">        saler.leader = sunqi</span><br><span class="line">        saler.manager = dongdong</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5.äººäº‹éƒ¨</span></span><br><span class="line">        hr.leader = wangwu</span><br><span class="line">        hr.manager = duoduo</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 6.è´¢åŠ¡éƒ¨</span></span><br><span class="line">        finance.leader = zhaoliu</span><br><span class="line">        finance.manager = duoduo</span><br><span class="line"></span><br><span class="line">        boarder.save()</span><br><span class="line">        developer.save()</span><br><span class="line">        operator.save()</span><br><span class="line">        saler.save()</span><br><span class="line">        hr.save()</span><br><span class="line">        finance.save()</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.stdout.write(<span class="string">&#x27;åˆå§‹ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœçœ‹ä¸æ‡‚æ¨¡å‹å­—æ®µçš„è®¾è®¡é€»è¾‘è¯·è‡ªè¡Œå‰å¾€ <a href="http://t.csdnimg.cn/Atp5H"><del>éƒ¨é—¨è¡¨è®¾è®¡: ç‚¹ä¸ªèµå†èµ°å‘— ğŸ˜­</del></a></p>
</blockquote>
<h3 id="ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“-1"><a href="#ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“-1" class="headerlink" title="ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“"></a>ç»ˆç«¯æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤å°†æ¨¡å‹åŒæ­¥è‡³æ•°æ®åº“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py inituser</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ç»ˆç«¯å°†ä¼šè¾“å‡º <strong>åˆå§‹ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼</strong></p>
<p><strong>å˜¿å˜¿! æ˜¯ä¸æ˜¯æœ‰äººæŠ¥é”™äº†? ğŸ˜‚</strong></p>
<blockquote>
<p>åœ¨ä¹‹å‰çš„æ•²ä»£ç æ—¶ï¼Œå¦‚æœå·²ç»æ‰§è¡Œäº†ç›¸å…³ä»£ç ï¼Œå¯¼è‡´æ•°æ®åº“ä¸­<strong>å·²ç»å­˜åœ¨äº†éƒ¨åˆ†ç”¨æˆ·æ•°æ®</strong>ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æ¸…é™¤è¿™äº›æ•°æ®ã€‚å¦‚æœé‡åˆ°åˆ é™¤æ“ä½œå¤±è´¥çš„æƒ…å†µï¼Œè¿™å¯èƒ½æ˜¯å› ä¸º department è¡¨ä¸ user è¡¨ä¹‹é—´å­˜åœ¨<strong>åŒå‘å¼•ç”¨å…³ç³»</strong>ï¼Œå¯¼è‡´æ•°æ®æ— æ³•ç›´æ¥åˆ é™¤ã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåšä¸»æ¨èé‡‡å–ä¸€ç§æ›´ä¸º<strong>æš´åŠ›ç›´æ¥</strong>çš„æ–¹æ³•ï¼šå³åˆ é™¤ç°æœ‰çš„ oa æ•°æ®åº“ï¼Œç„¶åé‡æ–°åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ oa æ•°æ®åº“<br>ä¸çŸ¥é“æ–¹æ³•çš„å¯ä»¥è·³è½¬åˆ°ä¸“æ ä¸‹çš„å¦ä¸€ç¯‡æ–‡ç« : <a href="http://t.csdnimg.cn/n9M3z">~æ•°æ®åº“é‡å»º: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<p>é‡å»ºæ•°æ®åº“ä¹‹åå†ä¾æ¬¡ç»ˆç«¯è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤å®Œæˆæ¨¡å‹æ˜ å°„:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line"></span><br><span class="line">python manage.py migrate</span><br><span class="line"></span><br><span class="line">python manage.py initdepartments</span><br><span class="line"></span><br><span class="line">python manage.py inituser</span><br></pre></td></tr></table></figure>

<p><strong>åˆ°æ­¤ï¼Œæµ‹è¯•æ•°æ®å·²ç»å…¨éƒ¨å®Œæˆäº†! å¦‚æœè§‰å¾—åšä¸»å†™çš„å¤Ÿè¯¦ç»†çš„è¯å°±ç•™æ¯å¥¶èŒ¶å†èµ°å‘—!ğŸ’</strong><br><strong>æ‚¨çš„æ”¯æŒå°±æ˜¯æˆ‘çš„åŠ¨åŠ›!ï¼ˆï¿£ â–½ ï¿£ï¼‰â†—</strong></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬èŠ‚è¯¦ç»†è®²è§£äº†å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰å‘½ä»¤ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰å‘½ä»¤æ¥åˆå§‹åŒ–æ•°æ®ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†é¡¹ç›®éƒ¨ç½²åæ•°æ®é¢„è®¾çš„éœ€æ±‚ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-è·¨åŸŸè¯·æ±‚é…ç½®(2)</title>
    <url>/2024/08/06/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E9%85%8D%E7%BD%AE-2/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="å‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­çš„è·¨åŸŸè¯·æ±‚é—®é¢˜"><a href="#å‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­çš„è·¨åŸŸè¯·æ±‚é—®é¢˜" class="headerlink" title="å‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­çš„è·¨åŸŸè¯·æ±‚é—®é¢˜"></a>å‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­çš„è·¨åŸŸè¯·æ±‚é—®é¢˜</h2><p>æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯ä¸åç«¯éƒ¨ç½²åœ¨ä¸åŒç«¯å£ï¼Œå¯¼è‡´å®ƒä»¬è¿è¡Œåœ¨ä¸åŒçš„åŸŸåä¸‹ã€‚ä¾‹å¦‚ï¼Œå‰ç«¯é¡µé¢é€šè¿‡<code>http://127.0.0.1:5173</code>è®¿é—®ï¼Œè€Œåç«¯æœåŠ¡ä½äº<code>http://127.0.0.1:8000</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå‰ç«¯å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®æ—¶ä¼šè§¦å‘è·¨åŸŸè¯·æ±‚ã€‚<br>è·¨åŸŸè¯·æ±‚çš„æˆåŠŸä¸å¦å–å†³äºæœåŠ¡ç«¯è®¾ç½®ï¼Œåªæœ‰æœåŠ¡ç«¯æ˜ç¡®å…è®¸ï¼Œå‰ç«¯æ‰èƒ½æˆåŠŸè®¿é—®æ•°æ®ã€‚<br>ç®€è€Œè¨€ä¹‹ï¼Œå‰ç«¯ä¸åç«¯çš„äº¤äº’éœ€è¦æœåŠ¡ç«¯çš„è·¨åŸŸé…ç½®æ”¯æŒã€‚</p>
<h2 id="è·¨åŸŸè¯·æ±‚é…ç½®"><a href="#è·¨åŸŸè¯·æ±‚é…ç½®" class="headerlink" title="è·¨åŸŸè¯·æ±‚é…ç½®"></a>è·¨åŸŸè¯·æ±‚é…ç½®</h2><h3 id="ä¸‹è½½è·¨åŸŸè¯·æ±‚å·¥å…·"><a href="#ä¸‹è½½è·¨åŸŸè¯·æ±‚å·¥å…·" class="headerlink" title="ä¸‹è½½è·¨åŸŸè¯·æ±‚å·¥å…·"></a>ä¸‹è½½è·¨åŸŸè¯·æ±‚å·¥å…·</h3><p><a href="https://pypi.org/project/django-cors-headers/">django-cors-headers</a> : Django çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºå¤„ç†è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰é—®é¢˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install django-cors-headers</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/08/06/GC5BKDebfp7iJnl.png" alt="image"><br><strong>Successfuly installdjango-cors-headers-4.4.0: ä¸‹è½½æˆåŠŸ</strong></p>
<p><img src="https://s2.loli.net/2024/08/06/AOHwDdgUeKXV8rJ.png" alt="image"></p>
<h3 id="settings-é…ç½®è·¨åŸŸè¯·æ±‚åº”ç”¨"><a href="#settings-é…ç½®è·¨åŸŸè¯·æ±‚åº”ç”¨" class="headerlink" title="settings é…ç½®è·¨åŸŸè¯·æ±‚åº”ç”¨"></a>settings é…ç½®è·¨åŸŸè¯·æ±‚åº”ç”¨</h3><h4 id="django-cors-headers-å®‰è£…"><a href="#django-cors-headers-å®‰è£…" class="headerlink" title="django-cors-headers å®‰è£…"></a>django-cors-headers å®‰è£…</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Application definition</span></span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&quot;django.contrib.admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.auth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.contenttypes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.staticfiles&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£…rest_framework</span></span><br><span class="line">    <span class="string">&#x27;rest_framework&#x27;</span>,</span><br><span class="line">    <span class="comment"># å®‰è£…django-cors-headers</span></span><br><span class="line">    <span class="string">&#x27;corsheaders&#x27;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="ä¸­é—´ä»¶é…ç½®"><a href="#ä¸­é—´ä»¶é…ç½®" class="headerlink" title="ä¸­é—´ä»¶é…ç½®"></a>ä¸­é—´ä»¶é…ç½®</h4><blockquote>
<p><strong>Tips:</strong> CorsMiddleware åº”è¯¥æ”¾åœ¨å°½å¯èƒ½ä¼˜å…ˆçš„ä½ç½®ï¼Œç‰¹åˆ«æ˜¯åœ¨ä»»ä½•å¯ä»¥äº§ç”Ÿå“åº”çš„ä¸­é—´ä»¶ä¹‹å‰ï¼Œæ¯”å¦‚ Django çš„ CommonMiddleware æˆ– Whitenoise çš„ WhiteNoiseMiddlewareã€‚å¦‚æœä¸åœ¨æ­¤ä¹‹å‰è®¾ç½®ï¼Œå°±æ— æ³•åœ¨è¿™äº›å“åº”ä¸­æ·»åŠ  CORS å¤´ä¿¡æ¯ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â€‹â€‹â€‹MIDDLEWARE = [</span><br><span class="line">    <span class="string">&quot;django.middleware.security.SecurityMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions.middleware.SessionMiddleware&quot;</span>,</span><br><span class="line">    <span class="comment"># ä¸­é—´ä»¶æŒ‰é¡ºåºæ‰§è¡Œ,ä¸€å®šè¦åœ¨CommonMiddlewareå‰é¢,å¦åˆ™ä¼šå‡ºç°è·¨åŸŸè¯·æ±‚å¤±è´¥çš„é—®é¢˜</span></span><br><span class="line">    <span class="string">&quot;corsheaders.middleware.CorsMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.middleware.common.CommonMiddleware&quot;</span>,</span><br><span class="line">    <span class="comment"># å…³é—­CSRFä¿æŠ¤</span></span><br><span class="line">    <span class="comment"># &quot;django.middleware.csrf.CsrfViewMiddleware&quot;,</span></span><br><span class="line">    <span class="string">&quot;django.contrib.auth.middleware.AuthenticationMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages.middleware.MessageMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.middleware.clickjacking.XFrameOptionsMiddleware&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="è·¨åŸŸè®¿é—®æƒé™é…ç½®"><a href="#è·¨åŸŸè®¿é—®æƒé™é…ç½®" class="headerlink" title="è·¨åŸŸè®¿é—®æƒé™é…ç½®"></a>è·¨åŸŸè®¿é—®æƒé™é…ç½®</h4><blockquote>
<p><strong>Tips:</strong> å¼€å‘é˜¶æ®µå‡ ä¹ä¸å­˜åœ¨å®‰å…¨é—®é¢˜,è®¾ç½®ä¸º True ä¾¿äºåç»­å¼€å‘</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â€‹â€‹<span class="comment"># å…è®¸æ‰€æœ‰åŸŸåè·¨åŸŸè®¿é—®(æ‰‹åŠ¨æ·»åŠ è‡³settings.pyæ–‡ä»¶ä¸­)</span></span><br><span class="line">CORS_ALLOW_ALL_ORIGINS = <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬èŠ‚è¯¦ç»†ä»‹ç»äº†åœ¨ Django å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„è·¨åŸŸè¯·æ±‚é—®é¢˜ï¼Œå¹¶å±•ç¤ºäº†ç›¸åº”çš„è§£å†³æ–¹æ¡ˆå’Œé…ç½®æ–¹æ³•ã€‚æ›´å¤šè·¨åŸŸè¯¦æƒ…è¯·è®¿é—®å®˜æ–¹æ–‡æ¡£è‡ªè¡Œé˜…è¯» â€“&gt; <a href="https://pypi.org/project/django-cors-headers/">django-cors-headers å®˜æ–¹æ–‡æ¡£ä¼ é€é—¨</a></p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-é‡å†™Useræ¨¡å‹(3)</title>
    <url>/2024/08/07/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E9%87%8D%E5%86%99User%E6%A8%A1%E5%9E%8B-3/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="å›½å†…å¤–-User-æ¨¡å‹çš„å·®å¼‚"><a href="#å›½å†…å¤–-User-æ¨¡å‹çš„å·®å¼‚" class="headerlink" title="å›½å†…å¤– User æ¨¡å‹çš„å·®å¼‚"></a>å›½å†…å¤– User æ¨¡å‹çš„å·®å¼‚</h2><p>å°½ç®¡ Django çš„ User æ¨¡å‹è®¾è®¡æˆç†Ÿï¼Œä½†ç”±äºå›½å†…å¤–ä½¿ç”¨ç¯å¢ƒå·®å¼‚ï¼Œå­˜åœ¨ä¸€äº›ä¸é€‚ç”¨å’Œç¼ºå¤±çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç¼ºå°‘å¯¹æ‰‹æœºå·çš„æ”¯æŒï¼Œä»¥åŠå›½å¤–å§“ååˆ†ä¸º first_name å’Œ last_nameã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸ç›´æ¥æ›¿æ¢åŸæœ‰çš„ User æ¨¡å‹ï¼Œè€Œæ˜¯é€‰æ‹©æ‰©å±•å®ƒã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ User æ¨¡å‹ä»¥é€‚åº”å›½å†…ç¯å¢ƒï¼ŒåŒæ—¶ä¿ç•™ Django å¼ºå¤§çš„å†…å»ºè®¤è¯ç³»ç»ŸåŠŸèƒ½ã€‚é€šè¿‡é‡å†™ User å¯¹è±¡ï¼Œæˆ‘ä»¬å®ç°äº†æ¨¡å‹çš„æœ¬åœ°åŒ–å®šåˆ¶ï¼Œç¡®ä¿äº†åŠŸèƒ½çš„å®Œæ•´æ€§å’Œæ‰©å±•æ€§ã€‚</p>
<h2 id="é‡å†™-User-æ¨¡å‹"><a href="#é‡å†™-User-æ¨¡å‹" class="headerlink" title="é‡å†™ User æ¨¡å‹"></a>é‡å†™ User æ¨¡å‹</h2><h3 id="ç»ˆç«¯åˆ›å»º-django-åº”ç”¨"><a href="#ç»ˆç«¯åˆ›å»º-django-åº”ç”¨" class="headerlink" title="ç»ˆç«¯åˆ›å»º django åº”ç”¨"></a>ç»ˆç«¯åˆ›å»º django åº”ç”¨</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py startapp oaauth</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°å¦‚ä¸‹åˆ›å»ºå¤±è´¥ï¼Œè¯·è‡ªè¡Œé€‰æ‹© MySQL æ•°æ®åº“é©±åŠ¨ç¨‹åº:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module.</span><br><span class="line">Did you install mysqlclient?</span><br></pre></td></tr></table></figure>

<p>ä»æ€§èƒ½ä¸Šæ¨è mysqlclientï¼Œä»æ“ä½œç®€æ˜“æ€§æ¨èä½¿ç”¨ pymysqlï¼Œæ­¤å¤„ä½¿ç”¨ pymysql ç¤ºä¾‹ï¼ˆç»ˆç«¯ä¸‹è½½ pymysqlï¼‰:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯·è‡ªè¡Œæ‰‹åŠ¨æ·»åŠ åˆ°é¡¹ç›®æ ¹ç›®å½•çš„__init__.pyæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­¤æ—¶å†æ¬¡è¿è¡Œ python manage.py startapp oaauthï¼Œåˆ™åä¸º oaauth çš„åº”ç”¨åˆ›å»ºæˆåŠŸ</p>
</blockquote>
<h3 id="åˆ›å»º-apps-ç®¡ç†åŒ…"><a href="#åˆ›å»º-apps-ç®¡ç†åŒ…" class="headerlink" title="åˆ›å»º apps ç®¡ç†åŒ…"></a>åˆ›å»º apps ç®¡ç†åŒ…</h3><blockquote>
<p>å› ä¸ºé¡¹ç›®ä¼šåˆ›å»ºä¼—å¤š app åº”ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†åœ¨æ­¤åˆ›å»ºä¸€ä¸ªåä¸º apps çš„è½¯ä»¶åŒ…è¿›è¡Œç»Ÿä¸€ç®¡ç†</p>
</blockquote>
<p>Tips: åˆ›å»ºå®Œæˆåéœ€å°† oaauth åº”ç”¨æ–‡ä»¶å¤¹æ”¾è¿› oaauth æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚ä¸‹:</p>
<p><img src="https://s2.loli.net/2024/08/07/2HsQ18kSwvgeTm7.png"></p>
<p><img src="https://s2.loli.net/2024/08/07/aDZPN1Gj2zQSp4l.png"></p>
<h3 id="settings-å®‰è£…-oaauth-åº”ç”¨"><a href="#settings-å®‰è£…-oaauth-åº”ç”¨" class="headerlink" title="settings å®‰è£… oaauth åº”ç”¨"></a>settings å®‰è£… oaauth åº”ç”¨</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Application definition</span></span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&quot;django.contrib.admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.auth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.contenttypes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.staticfiles&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£…rest_framework</span></span><br><span class="line">    <span class="string">&#x27;rest_framework&#x27;</span>,</span><br><span class="line">    <span class="comment"># å®‰è£…django-cors-headers</span></span><br><span class="line">    <span class="string">&#x27;corsheaders&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;apps.oaauth&#x27;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="é‡å†™-User-æ¨¡å‹-1"><a href="#é‡å†™-User-æ¨¡å‹-1" class="headerlink" title="é‡å†™ User æ¨¡å‹"></a>é‡å†™ User æ¨¡å‹</h3><blockquote>
<p>æ‰“å¼€ apps â€“&gt; oaauth â€“&gt;models.py æ–‡ä»¶</p>
</blockquote>
<h4 id="å¯¼å…¥-User-æ¨¡å‹"><a href="#å¯¼å…¥-User-æ¨¡å‹" class="headerlink" title="å¯¼å…¥ User æ¨¡å‹"></a>å¯¼å…¥ User æ¨¡å‹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User</span><br></pre></td></tr></table></figure>

<h4 id="å¤åˆ¶-User-æ¨¡å‹"><a href="#å¤åˆ¶-User-æ¨¡å‹" class="headerlink" title="å¤åˆ¶ User æ¨¡å‹"></a>å¤åˆ¶ User æ¨¡å‹</h4><blockquote>
<p>ç”±äº User æ¨¡å‹åŸºäº AbstractUser æ‰©å±•ï¼Œè€Œ AbstractUser åˆç»§æ‰¿è‡ª AbstractBaseUser å’Œ PermissionsMixinï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨ AbstractUser ç±»ä¸Šè¿›è¡Œé‡å†™ï¼Œå¤åˆ¶å…¶ä»£ç ä»¥å®ç°è‡ªå®šä¹‰ã€‚</p>
</blockquote>
<h4 id="é‡å†™-User-æ¨¡å‹-2"><a href="#é‡å†™-User-æ¨¡å‹-2" class="headerlink" title="é‡å†™ User æ¨¡å‹"></a>é‡å†™ User æ¨¡å‹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">â€‹â€‹<span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User, AbstractBaseUser, PermissionsMixin, BaseUserManager</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.hashers <span class="keyword">import</span> make_password</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserStatusChoices</span>(models.IntegerChoices):</span><br><span class="line">    <span class="comment"># å·²ç»æ¿€æ´»</span></span><br><span class="line">    ACTIVED = <span class="number">1</span></span><br><span class="line">    <span class="comment"># æ²¡æœ‰æ¿€æ´»</span></span><br><span class="line">    UNACTIVE = <span class="number">2</span></span><br><span class="line">    <span class="comment"># è¢«é”å®š</span></span><br><span class="line">    LOCKED = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OAUserManager</span>(<span class="title class_ inherited__">BaseUserManager</span>):</span><br><span class="line">    use_in_migrations = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¯†ç æºè‡ªäºAbstractBaseUserç±»</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_create_user</span>(<span class="params">self, realname, email, password, **extra_fields</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> realname:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;å¿…é¡»è®¾ç½®çœŸå®å§“å! &quot;</span>)</span><br><span class="line">        email = <span class="variable language_">self</span>.normalize_email(email)  <span class="comment"># é‚®ç®±æ ‡å‡†åŒ–</span></span><br><span class="line">        user = <span class="variable language_">self</span>.model(realname=realname, email=email, **extra_fields)  <span class="comment"># æ­¤å¤„çš„self.modelå®é™…ä¸Šç­‰äºOAUser</span></span><br><span class="line">        user.password = make_password(password)</span><br><span class="line">        user.save(using=<span class="variable language_">self</span>._db)</span><br><span class="line">        <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_user</span>(<span class="params">self, realname, email=<span class="literal">None</span>, password=<span class="literal">None</span>, **extra_fields</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆ›å»ºæ™®é€šç”¨æˆ·</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        extra_fields.setdefault(<span class="string">&quot;is_staff&quot;</span>, <span class="literal">True</span>)</span><br><span class="line">        extra_fields.setdefault(<span class="string">&quot;is_superuser&quot;</span>, <span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._create_user(realname, email, password, **extra_fields)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_superuser</span>(<span class="params">self, realname, email=<span class="literal">None</span>, password=<span class="literal">None</span>, **extra_fields</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆ›å»ºè¶…çº§ç”¨æˆ·</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        extra_fields.setdefault(<span class="string">&quot;is_staff&quot;</span>, <span class="literal">True</span>)</span><br><span class="line">        extra_fields.setdefault(<span class="string">&quot;is_superuser&quot;</span>, <span class="literal">True</span>)</span><br><span class="line">        extra_fields.setdefault(<span class="string">&quot;status&quot;</span>, UserStatusChoices.ACTIVED)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> extra_fields.get(<span class="string">&quot;is_staff&quot;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;è¶…çº§ç”¨æˆ·å¿…é¡»è®¾ç½®is_staff=True.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> extra_fields.get(<span class="string">&quot;is_superuser&quot;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;è¶…çº§ç”¨æˆ·å¿…é¡»è®¾ç½®is_superuser=True.&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._create_user(realname, email, password, **extra_fields)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OAUser</span>(AbstractBaseUser, PermissionsMixin):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è‡ªå®šä¹‰çš„Useræ¨¡å‹</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    realname = models.CharField(max_length=<span class="number">150</span>, unique=<span class="literal">False</span>)  <span class="comment"># å…¬å¸ä½“é‡åºå¤§,å¯èƒ½ä¼šå‡ºç°åŒåè€…</span></span><br><span class="line">    email = models.EmailField(unique=<span class="literal">True</span>, blank=<span class="literal">False</span>)  <span class="comment"># é‚®ç®±å”¯ä¸€ä¸”ä¸ä¸ºç©º</span></span><br><span class="line">    telephone = models.CharField(max_length=<span class="number">20</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    is_staff = models.BooleanField(default=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># åªè¦å…³æ³¨statuså³å¯,æ— é¡»å…³æ³¨is_active</span></span><br><span class="line">    status = models.IntegerField(choices=UserStatusChoices, default=UserStatusChoices.UNACTIVE)</span><br><span class="line">    is_active = models.BooleanField(default=<span class="literal">True</span>)</span><br><span class="line">    date_joined = models.DateTimeField(auto_now_add=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    objects = OAUserManager()</span><br><span class="line"></span><br><span class="line">    EMAIL_FIELD = <span class="string">&quot;email&quot;</span></span><br><span class="line">    <span class="comment"># USERNAME_FIELD: æ˜¯ç”¨æ¥åšé‰´æƒçš„,ä¼šæŠŠauthenticateçš„usernameå‚æ•°ä¼ ç»™USERNAME_FIELDæŒ‡å®šçš„å­—æ®µ</span></span><br><span class="line">    <span class="comment"># form django.contrib.auth import authenticate</span></span><br><span class="line">    USERNAME_FIELD = <span class="string">&quot;email&quot;</span></span><br><span class="line">    <span class="comment"># REQUIRED_FIELDS: æŒ‡å®šå“ªäº›å­—æ®µæ—¶å¿…é¡»è¦ä¼ çš„,ä½†æ˜¯ä¸èƒ½é‡å¤åŒ…å«USERNAME_FIELDå’ŒEMAIL_FIELDå·²ç»è®¾ç½®è¿‡çš„å€¼</span></span><br><span class="line">    REQUIRED_FIELDS = [<span class="string">&quot;realname&quot;</span>, <span class="string">&quot;password&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clean</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().clean()</span><br><span class="line">        <span class="variable language_">self</span>.email = <span class="variable language_">self</span>.__class__.objects.normalize_email(<span class="variable language_">self</span>.email)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_full_name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.realname</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_short_name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.realname</span><br></pre></td></tr></table></figure>

<h4 id="setttings-è¦†ç›–åŸæœ‰-User-æ¨¡å‹"><a href="#setttings-è¦†ç›–åŸæœ‰-User-æ¨¡å‹" class="headerlink" title="setttings è¦†ç›–åŸæœ‰ User æ¨¡å‹"></a>setttings è¦†ç›–åŸæœ‰ User æ¨¡å‹</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¦†ç›–djangoè‡ªå¸¦çš„Useræ¨¡å‹</span></span><br><span class="line"><span class="comment"># æ ¼å¼: &#x27;app.&lt;Useræ¨¡å‹å&gt;&#x27;</span></span><br><span class="line">AUTH_USER_MODEL = <span class="string">&quot;oaauth.OAUser&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é”™è¯¯ç¤ºä¾‹:</span></span><br><span class="line"><span class="comment"># AUTH_USER_MODEL = &#x27;apps.oaauth.models.OAUser&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡å‹æ˜ å°„"><a href="#æ¨¡å‹æ˜ å°„" class="headerlink" title="æ¨¡å‹æ˜ å°„"></a>æ¨¡å‹æ˜ å°„</h2><p>ç»ˆç«¯ä¾æ¬¡è¿è¡Œ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<p>è‹¥æ•°æ®åº“åŒæ­¥æˆåŠŸåˆ™æ˜¾ç¤ºå¦‚ä¸‹:<br><img src="https://s2.loli.net/2024/08/07/Q15LSmAq2NJrkoD.png"></p>
<h2 id="æµ‹è¯•-åˆ›å»ºè¶…çº§ç”¨æˆ·"><a href="#æµ‹è¯•-åˆ›å»ºè¶…çº§ç”¨æˆ·" class="headerlink" title="æµ‹è¯•: åˆ›å»ºè¶…çº§ç”¨æˆ·"></a>æµ‹è¯•: åˆ›å»ºè¶…çº§ç”¨æˆ·</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">(venv) PS D:\yourterminal&gt; python manage.py createsuperuser</span><br><span class="line">Email: dianzanjiaguanzhu@qq.com</span><br><span class="line">Realname: dianzanjiaguanzhu</span><br><span class="line">å¯†ç : <span class="number">123456</span></span><br><span class="line">Superuser created successfully.</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/08/07/utorH2XTUEKwgJA.png"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬èŠ‚è¯¦ç»†ä»‹ç»äº†å¯¹ Django æ¡†æ¶ä¸­ User å¯¹è±¡çš„é‡å†™è¿‡ç¨‹åŠå…¶åº”ç”¨ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Django5+Vue3:OAç³»ç»Ÿå‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜-é¡¹ç›®åˆå§‹åŒ–(1)</title>
    <url>/2024/08/06/Django5-Vue3-OA%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96-1/</url>
    <content><![CDATA[<h1 id="Django5-Vue3-ç³»åˆ—æ–‡ç« "><a href="#Django5-Vue3-ç³»åˆ—æ–‡ç« " class="headerlink" title="Django5+Vue3 ç³»åˆ—æ–‡ç« "></a>Django5+Vue3 ç³»åˆ—æ–‡ç« </h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>æ­¤é¡¹ç›®é‡‡ç”¨ Django æ¡†æ¶çš„ 5.0.7 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ã€‚<br>Django 5.0 æ”¯æŒçš„ Python ç‰ˆæœ¬ä¸º 3.10ã€3.11 å’Œ 3.12ã€‚<br>OA ç³»ç»Ÿç³»åˆ—æ–‡ç« å°†æŒç»­æ›´æ–°ï¼Œç›´è‡³é¡¹ç›®çš„ Docker éƒ¨ç½²é˜¶æ®µã€‚<br>CSDN ä¸“æ é“¾æ¥:Â <a href="http://t.csdnimg.cn/oMuU0">~å¿«æ·ä¼ é€é—¨: ç•™ä¸ªèµå†èµ°å‘— ğŸ˜­! ~</a></p>
</blockquote>
<h2 id="pycharm-åˆå§‹åŒ–-django5-é¡¹ç›®"><a href="#pycharm-åˆå§‹åŒ–-django5-é¡¹ç›®" class="headerlink" title="pycharm åˆå§‹åŒ– django5 é¡¹ç›®"></a>pycharm åˆå§‹åŒ– django5 é¡¹ç›®</h2><p><img src="https://s2.loli.net/2024/08/06/nzbqFCoe5DV2Wit.png" alt="image"></p>
<h2 id="åˆ›å»º-MySQL-æ•°æ®åº“"><a href="#åˆ›å»º-MySQL-æ•°æ®åº“" class="headerlink" title="åˆ›å»º MySQL æ•°æ®åº“"></a>åˆ›å»º MySQL æ•°æ®åº“</h2><h3 id="MySQL-åˆ›å»º-oa-æ•°æ®åº“"><a href="#MySQL-åˆ›å»º-oa-æ•°æ®åº“" class="headerlink" title="MySQL åˆ›å»º oa æ•°æ®åº“"></a>MySQL åˆ›å»º oa æ•°æ®åº“</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE oa <span class="keyword">DEFAULT</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4;</span><br></pre></td></tr></table></figure>

<h3 id="æ›´æ”¹é¡¹ç›®-settings-é…ç½®"><a href="#æ›´æ”¹é¡¹ç›®-settings-é…ç½®" class="headerlink" title="æ›´æ”¹é¡¹ç›® settings é…ç½®"></a>æ›´æ”¹é¡¹ç›® settings é…ç½®</h3><h4 id="é…ç½®æ•°æ®åº“"><a href="#é…ç½®æ•°æ®åº“" class="headerlink" title="é…ç½®æ•°æ®åº“"></a>é…ç½®æ•°æ®åº“</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&quot;default&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;ENGINE&quot;</span>: <span class="string">&quot;django.db.backends.mysql&quot;</span>,</span><br><span class="line">        <span class="string">&quot;NAME&quot;</span>: <span class="string">&quot;oa&quot;</span>,</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: <span class="string">&quot;&lt;password&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: <span class="number">3306</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å®‰è£…-rest-framework"><a href="#å®‰è£…-rest-framework" class="headerlink" title="å®‰è£… rest_framework"></a>å®‰è£… rest_framework</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Application definition</span></span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&quot;django.contrib.admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.auth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.contenttypes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.staticfiles&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£…rest_framework</span></span><br><span class="line">    <span class="string">&#x27;rest_framework&#x27;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="å…³é—­-CSRF-ä¿æŠ¤"><a href="#å…³é—­-CSRF-ä¿æŠ¤" class="headerlink" title="å…³é—­ CSRF ä¿æŠ¤"></a>å…³é—­ CSRF ä¿æŠ¤</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">&quot;django.middleware.security.SecurityMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.sessions.middleware.SessionMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.middleware.common.CommonMiddleware&quot;</span>,</span><br><span class="line">    <span class="comment"># å…³é—­CSRFä¿æŠ¤</span></span><br><span class="line">    <span class="comment"># &quot;django.middleware.csrf.CsrfViewMiddleware&quot;,</span></span><br><span class="line">    <span class="string">&quot;django.contrib.auth.middleware.AuthenticationMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.contrib.messages.middleware.MessageMiddleware&quot;</span>,</span><br><span class="line">    <span class="string">&quot;django.middleware.clickjacking.XFrameOptionsMiddleware&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œç”±äºæˆ‘ä»¬ä¸å†ä¾èµ– Django æ¨¡æ¿ç³»ç»Ÿï¼Œä¸”æ‰€æœ‰èº«ä»½éªŒè¯æµç¨‹å‡é€šè¿‡ JWT Token å®ç°ï¼Œå› æ­¤ CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ”»å‡»çš„å¨èƒå·²è¢«æœ‰æ•ˆç¼“è§£ã€‚é‰´äºæ­¤ï¼Œæˆ‘ä»¬å»ºè®®ç¦ç”¨ Django çš„ CSRF ä¿æŠ¤æœºåˆ¶ã€‚æ­¤ä¸¾ä¸ä»…ç®€åŒ–äº†å‰ç«¯é¡µé¢çš„æ¸²æŸ“æµç¨‹ï¼Œé¿å…äº†é¢‘ç¹è·å– CSRF Token çš„ç¹çæ“ä½œï¼ŒåŒæ—¶ä¹Ÿä¸æˆ‘ä»¬é‡‡ç”¨çš„åŸºäº JWT çš„èº«ä»½éªŒè¯ç­–ç•¥ç›¸å¥‘åˆã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨æœ¬é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ PyCharm å¿«é€Ÿæ­å»ºäº† Django 5 é¡¹ç›®ï¼Œå¹¶æˆåŠŸé…ç½®äº†ç›¸åº”çš„æ•°æ®åº“ã€‚åŒæ—¶ï¼Œå¯¹ settings.py è¿›è¡Œäº†é€‚å½“è°ƒæ•´ï¼Œä»¥ç¡®ä¿é¡¹ç›®é…ç½®çš„ä¼˜åŒ–å’Œé€‚é…ã€‚</p>
]]></content>
      <categories>
        <category>å‰åç«¯åˆ†ç¦»</category>
      </categories>
      <tags>
        <tag>Django</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
</search>
